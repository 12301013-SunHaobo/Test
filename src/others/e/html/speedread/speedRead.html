<!--
line-height:24px
font-size:16px

table.offsetHeight=line-height * lineNumber + (3+3) //if table.border=0


-->
<body onload="load()" >
<input type="button" onClick="startReading()" value="Scroll Page"><BR>
<table id="mainTable" width="545" border="0"><tr><td>
<p style="font-size:16px; line-height: 24px;" onClick="toggleScroll()"> 

<font face="times new roman"><!-- arial   -->
<!--  
<BR>&nbsp;&nbsp;&nbsp;&nbsp;
-->
<!--  CHANGE begin   -->



<!-- CHANGE end -->
</font></p> 
</td></tr></table>	
<BR>
<input type="button" onClick="stopScroll(),goback()" value="Stop Scrolling & go back">
<script type="text/javascript">
//CHANGE begin
var totalWords = 5334;//total words //5334
var speed = 300; //words/min 250, 300, 
//for Chinese: 3000, 5000
//CHANGE end

var scroll = false;
var totalTime = 0; //total seconds to display whole passage
var tableHeight = 0;
var scrollPerNMillisecond = 0;
var scrolldelay;

function load() {
	var mainTable = window.document.getElementById('mainTable');
	tableHeight = mainTable.offsetHeight;
	
	totalTime = (totalWords / speed) * 60;
	scrollPerNMillisecond = totalTime * 1000 / tableHeight;
	
	//alert("tableHeight="+tableHeight+";sroll/ms="+scrollPerNMillisecond);
}
function startReading() {
	if(!scroll){
		scroll = true;
		pageScroll();
	}
}
function toggleScroll() {
	if(scroll) {
		scroll = false;
		stopScroll();
	} else {
		scroll = true;
		pageScroll();
	}
}
function goback() {
	scroll = false;
	window.scrollTo(0,0);
}
function pageScroll() {
    window.scrollBy(0,1); // horizontal and vertical scroll increments
    scrolldelay = setTimeout('pageScroll()', scrollPerNMillisecond); // scrolls every n milliseconds
}
function stopScroll() {
    clearTimeout(scrolldelay);
}
</script>
</body>
